<html>
<head>
    <!--https://apps.mypurecloud.com/crm/index.html?crm=salesforce&color=darkblue-->

    <!-- Imports Open CTI JavaScript library. Point to a valid Salesforce domain.-->
    <script src="https://maserati--devlex.sandbox.lightning.force.com/support/api/62.0/lightning/opencti_min.js"></script>
    <script type="text/javascript">

        var BARRA_MC_IN = "purecloud__ClientEvent__c";
        var BARRA_MC_OUT = "purecloud__ClientEvent__c";
        var BARRA_MC_IN_SUBSCRIPTION = null;


        function publishSampleMC(message) {
            sforce.opencti.publish({
                channelName: BARRA_MC_OUT,
                message: message,
                callback: lightningMessageServiceCallback
            });
        };

        function lightningMessageServiceCallback(result) {
            if (result.success) {
                console.log('Success publish');
            } else {
                console.log('Error: ' + result.errors);
            }
        };

        function startCall() {
            var message = {
                type: "interaction",
                recordData : {
                    matricola : 'matricola',
                    telefono : 'telefono',
                    cod_esito : 'codice'
                }
            }
            publishSampleMC(message);
        }

        function endCall() {
            var message = {
                type: "interaction",
                recordData : {
                    matricola : 'matricola',
                    telefono : 'telefono',
                    cod_esito : 'codice'
                }
            }
            publishSampleMC(message);
        }
    </script>
</head>
<body>
    <button onclick="startCall();">Simula chiamata iniziata</button><br/>
    <button onclick="endCall();">Simula chiamata finita</button><br/>
</body>
</html>
